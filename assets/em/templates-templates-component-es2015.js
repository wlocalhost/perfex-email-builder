(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{BsGo:function(e,t,a){"use strict";a.r(t),a.d(t,"TemplatesComponent",(function(){return je}));var n=a("mrSG"),i=a("XNiG"),c=a("2Vo4"),o=a("xgIS"),l=a("LRne"),s=a("EY2u"),b=a("Cfvw"),r=a("XqQ8"),m=a("lJxs"),d=a("1G5W"),p=a("vkgz"),u=a("JIr8"),g=a("IzEk"),f=a("nYR2"),h=a("z6cu"),P=a("UXun"),w=a("uSps"),y=a("fXoL"),v=a("tk/3"),O=a("dNgK");let C=(()=>{class e{constructor(e,t){this.http=e,this.matSnack=t,this._isLoading$=new i.a,this.isLoading$=this._isLoading$.asObservable()}httpRequest(e,t={},a="get",n){return this._isLoading$.next(!0),this.matSnack.open("Please wait..."),this.http.request(a,`${globalThis.NGB.baseUrl}/${e}`,{params:t,body:n,responseType:"json"}).pipe(Object(u.a)(e=>(e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):(console.error(`Backend returned code ${e.status}`),this.matSnack.open(`Something bad happened; please try again later. "Error Status ${e.status}".`,"Close",{announcementMessage:"Something bad happened; please try again later."})),console.error(e),Object(h.a)(new Error("Something bad happened; please try again later.")))),Object(p.a)(()=>this.matSnack.dismiss()),Object(f.a)(()=>this._isLoading$.next(!1)))}getTemplatesByLang(e){return this.httpRequest("templates",{language:e})}getTemplateBody(e){return this.httpRequest("getEmailTemplate",{emailtemplateid:e})}getTemplate(e){return this.httpRequest("getTemplate",{emailtemplateid:e}).pipe(Object(m.a)(e=>({isEdited:!!e.emailObject,email:new w.a(e.emailObject||{structures:[new w.f("cols_1",[[new w.g(e.message)]])]})})))}revertTemplate(e){return this.sendPostRequest(new FormData,`revertTemplate/${e}`).pipe(Object(m.a)(e=>({isEdited:!1,email:new w.a({structures:[new w.f("cols_1",[[new w.g(e.message)]])]})})))}getAllLanguages(){return this.httpRequest("languages").pipe(Object(P.a)(),Object(u.a)(()=>Object(l.a)([])))}getAllMergeFields(e){return this.httpRequest("mergeFields",{type:e}).pipe(Object(u.a)(()=>Object(l.a)([])))}sendPostRequest(e=new FormData,t){const{token:a,name:n}=globalThis.NGB.token;return e.append(n,a),this.httpRequest(t,{},"post",e)}}return e.\u0275fac=function(t){return new(t||e)(y.Ub(v.a),y.Ub(O.a))},e.\u0275prov=y.Gb({token:e,factory:e.\u0275fac,providedIn:"any"}),e})();var j=a("0IaG"),Q=a("ofXK"),x=a("XiUz"),$=a("bTqV"),k=a("3Pt+"),T=a("kmnG"),A=a("qFsG"),L=a("MutI"),D=a("f0Cb");function I(e,t){1&e&&(y.Ob(0),y.Qb(1,"h2",2),y.Cc(2,"Are you sure?"),y.Pb(),y.Qb(3,"mat-dialog-content"),y.Cc(4," You are about to close the builder, but there're unsaved changes, which will be lost. Are you sure? "),y.Pb(),y.Qb(5,"mat-dialog-actions",3),y.Qb(6,"button",4),y.Cc(7," No, Go back! "),y.Pb(),y.Qb(8,"button",5),y.Cc(9," Yes, Close it. "),y.Pb(),y.Pb(),y.Nb()),2&e&&(y.wb(8),y.ic("mat-dialog-close",!0))}function _(e,t){1&e&&(y.Ob(0),y.Qb(1,"h2",2),y.Cc(2,"Are you sure?"),y.Pb(),y.Qb(3,"mat-dialog-content"),y.Qb(4,"p"),y.Cc(5,"You are about to restore this template to default Perfex template, all additional changes will be lost."),y.Pb(),y.Qb(6,"p"),y.Qb(7,"strong"),y.Qb(8,"strong"),y.Cc(9,"This will affect only template body, not name nor subject."),y.Pb(),y.Pb(),y.Pb(),y.Qb(10,"p"),y.Qb(11,"strong"),y.Cc(12,"Are you sure?"),y.Pb(),y.Pb(),y.Pb(),y.Qb(13,"mat-dialog-actions",3),y.Qb(14,"button",4),y.Cc(15," No, Go back! "),y.Pb(),y.Qb(16,"button",5),y.Cc(17," Yes, Restore it. "),y.Pb(),y.Pb(),y.Nb()),2&e&&(y.wb(16),y.ic("mat-dialog-close",!0))}function F(e,t){if(1&e&&(y.Qb(0,"mat-list-item"),y.Qb(1,"div",16),y.Qb(2,"span"),y.Cc(3),y.Pb(),y.Qb(4,"code"),y.Cc(5),y.Pb(),y.Pb(),y.Pb()),2&e){const e=y.cc().$implicit;y.wb(3),y.Dc(e.name),y.wb(2),y.Dc(e.key)}}function M(e,t){1&e&&y.Lb(0,"mat-divider")}function E(e,t){if(1&e&&(y.Ob(0),y.Ac(1,F,6,2,"mat-list-item",1),y.Ac(2,M,1,0,"mat-divider",1),y.Nb()),2&e){const e=t.$implicit;y.wb(1),y.ic("ngIf",e.key),y.wb(1),y.ic("ngIf",e.key)}}function S(e,t){if(1&e&&(y.Qb(0,"mat-list",14),y.Ac(1,E,3,2,"ng-container",15),y.Pb()),2&e){const e=y.cc(2);y.wb(1),y.ic("ngForOf",e.data.mergeFields)}}function R(e,t){if(1&e&&(y.Ob(0),y.Qb(1,"h2",2),y.Cc(2,"Edit details"),y.Pb(),y.Qb(3,"mat-dialog-content"),y.Qb(4,"form",null,6),y.Lb(6,"input",7),y.Qb(7,"mat-form-field",8),y.Qb(8,"mat-label"),y.Cc(9,"From Name"),y.Pb(),y.Lb(10,"input",9),y.Pb(),y.Qb(11,"mat-form-field",8),y.Qb(12,"mat-label"),y.Cc(13,"Subject"),y.Pb(),y.Lb(14,"input",10),y.Pb(),y.Pb(),y.Ac(15,S,2,1,"mat-list",11),y.Pb(),y.Qb(16,"mat-dialog-actions",3),y.Qb(17,"button",12),y.Cc(18," Cancel "),y.Pb(),y.Qb(19,"button",13),y.Cc(20," Save "),y.Pb(),y.Pb(),y.Nb()),2&e){const e=y.oc(5),t=y.cc();y.wb(6),y.ic("value",t.data.data.emailtemplateid),y.wb(4),y.ic("value",t.data.data.fromname),y.wb(4),y.ic("value",t.data.data.subject),y.wb(1),y.ic("ngIf",t.data.mergeFields),y.wb(4),y.ic("disabled",!t.checkValidity(e))("mat-dialog-close",e)}}function N(e,t){if(1&e&&(y.Ob(0),y.Qb(1,"h2",2),y.Cc(2,"Send test email"),y.Pb(),y.Qb(3,"mat-dialog-content"),y.Lb(4,"form",null,17),y.Pb(),y.Qb(6,"mat-dialog-actions",3),y.Qb(7,"button",4),y.Cc(8," No, Go back! "),y.Pb(),y.Qb(9,"button",5),y.Cc(10," Yes, Close it. "),y.Pb(),y.Pb(),y.Nb()),2&e){const e=y.oc(5);y.wb(9),y.ic("mat-dialog-close",e)}}let Y=(()=>{class e{constructor(e){this.data=e}checkValidity(e){return e.checkValidity()}}return e.\u0275fac=function(t){return new(t||e)(y.Kb(j.a))},e.\u0275cmp=y.Eb({type:e,selectors:[["app-modal-dialog"]],decls:5,vars:4,consts:[[1,"mat-typography"],[4,"ngIf"],["mat-dialog-title",""],["fxLayoutAlign","space-between center"],["mat-button","","color","warn","cdkFocusInitial","","mat-dialog-close",""],["mat-button","",3,"mat-dialog-close"],["form",""],["type","hidden","name","emailtemplateid",3,"value"],["appearance","fill"],["matInput","","name","fromname","required","","type","text",3,"value"],["matInput","","name","subject","required","","type","text",3,"value"],["dense","",4,"ngIf"],["mat-button","","mat-dialog-close",""],["mat-button","","color","primary","cdkFocusInitial","",3,"disabled","mat-dialog-close"],["dense",""],[4,"ngFor","ngForOf"],["fxFlex","","fxLayout","","fxLayoutAlign","space-between center"],["form","ngForm"]],template:function(e,t){1&e&&(y.Qb(0,"div",0),y.Ac(1,I,10,1,"ng-container",1),y.Ac(2,_,18,1,"ng-container",1),y.Ac(3,R,21,6,"ng-container",1),y.Ac(4,N,11,1,"ng-container",1),y.Pb()),2&e&&(y.wb(1),y.ic("ngIf","confirm"===t.data.type),y.wb(1),y.ic("ngIf","confirm-revert"===t.data.type),y.wb(1),y.ic("ngIf","edit"===t.data.type),y.wb(1),y.ic("ngIf","test-email"===t.data.type))},directives:[Q.i,j.h,j.e,j.c,x.b,$.a,j.d,k.n,k.i,k.j,T.b,T.f,A.a,L.a,Q.h,L.c,x.a,x.c,D.a],styles:["[_nghost-%COMP%]{display:block}mat-form-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;height:auto}mat-list[_ngcontent-%COMP%]{max-height:300px;overflow:auto}mat-list[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{-webkit-user-select:all;-moz-user-select:all;-ms-user-select:all;user-select:all}"]}),e})();var G=a("XhcP"),q=a("/t3+"),B=a("STbY"),z=a("7EHt"),V=a("bv9b"),K=a("+0xr"),X=a("1jcm"),J=a("Qu3c"),U=a("NFeN");let H=(()=>{class e{transform(e,...t){return e.split("_").join(" ")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=y.Jb({name:"keyToLang",type:e,pure:!0}),e})();const W=["sidenav"];function Z(e,t){1&e&&y.Lb(0,"mat-progress-bar",15)}function ee(e,t){if(1&e&&(y.Qb(0,"button",16),y.Cc(1),y.Pb()),2&e){const e=t.ngIf;y.wb(1),y.Ec(" ",e," ")}}function te(e,t){if(1&e){const e=y.Rb();y.Ob(0),y.Qb(1,"button",18),y.Yb("click",(function(){y.rc(e);const a=t.$implicit;return y.cc(2).changeLanguage(a)})),y.Cc(2),y.dc(3,"keyToLang"),y.Pb(),y.Nb()}if(2&e){const e=t.$implicit;y.wb(2),y.Ec(" ",y.ec(3,1,e)," ")}}function ae(e,t){if(1&e&&(y.Ac(0,te,4,3,"ng-container",17),y.dc(1,"async")),2&e){const e=y.cc();y.ic("ngForOf",y.ec(1,1,e.languages$))}}function ne(e,t){1&e&&y.Lb(0,"mat-header-cell")}function ie(e,t){if(1&e){const e=y.Rb();y.Qb(0,"mat-cell"),y.Qb(1,"mat-slide-toggle",33),y.Yb("change",(function(a){y.rc(e);const n=t.$implicit;return y.cc(2).changeActiveStatus(a,n)})),y.dc(2,"async"),y.Pb(),y.Pb()}if(2&e){const e=t.$implicit,a=y.cc(2);y.wb(1),y.ic("checked",e.active-0==1)("disabled",y.ec(2,2,a.res.isLoading$))}}function ce(e,t){1&e&&(y.Qb(0,"mat-header-cell"),y.Cc(1,"Name"),y.Pb())}function oe(e,t){if(1&e&&(y.Qb(0,"span"),y.Cc(1),y.Pb()),2&e){const e=y.cc().$implicit;y.wb(1),y.Dc(e.name)}}function le(e,t){if(1&e&&(y.Qb(0,"del"),y.Cc(1),y.Pb()),2&e){const e=y.cc().$implicit;y.wb(1),y.Dc(e.name)}}function se(e,t){if(1&e&&(y.Qb(0,"mat-cell"),y.Ac(1,oe,2,1,"span",14),y.Ac(2,le,2,1,"del",14),y.Pb()),2&e){const e=t.$implicit;y.wb(1),y.ic("ngIf","1"===e.active),y.wb(1),y.ic("ngIf","1"!==e.active)}}function be(e,t){1&e&&(y.Qb(0,"mat-header-cell"),y.Cc(1," From Name > Subject "),y.Pb())}function re(e,t){if(1&e&&(y.Qb(0,"span"),y.Cc(1),y.Pb()),2&e){const e=y.cc().$implicit;y.wb(1),y.Ec(" ",e.fromname," > ")}}function me(e,t){if(1&e&&(y.Qb(0,"span"),y.Cc(1),y.dc(2,"date"),y.Pb()),2&e){const e=y.cc().$implicit;y.wb(1),y.Dc(y.fc(2,1,e.updated_at,"short"))}}function de(e,t){1&e&&(y.Qb(0,"span"),y.Cc(1,"-"),y.Pb())}function pe(e,t){if(1&e){const e=y.Rb();y.Qb(0,"mat-cell",34),y.Qb(1,"div"),y.Ac(2,re,2,1,"span",14),y.Cc(3),y.Pb(),y.Qb(4,"div",35),y.Qb(5,"span",36),y.Ac(6,me,3,4,"span",14),y.Ac(7,de,2,0,"span",14),y.Pb(),y.Qb(8,"button",37),y.Yb("click",(function(){y.rc(e);const a=t.$implicit,n=y.cc().$implicit;return y.cc().changeElementDetails(a,n.key)})),y.dc(9,"async"),y.Qb(10,"mat-icon"),y.Cc(11,"edit"),y.Pb(),y.Pb(),y.Pb(),y.Pb()}if(2&e){const e=t.$implicit,a=y.cc(2);y.wb(2),y.ic("ngIf",e.fromname),y.wb(1),y.Ec(" ",e.subject," "),y.wb(3),y.ic("ngIf",e.updated_at),y.wb(1),y.ic("ngIf",!e.updated_at),y.wb(1),y.ic("disabled",y.ec(9,5,a.res.isLoading$))}}function ue(e,t){1&e&&(y.Qb(0,"mat-header-cell",38),y.Cc(1," Actions "),y.Pb())}function ge(e,t){1&e&&(y.Qb(0,"mat-icon"),y.Cc(1," visibility "),y.Pb())}function fe(e,t){1&e&&(y.Qb(0,"mat-icon"),y.Cc(1," visibility_off "),y.Pb())}function he(e,t){if(1&e){const e=y.Rb();y.Qb(0,"mat-cell",39),y.Qb(1,"button",40),y.Yb("click",(function(){y.rc(e);const a=t.$implicit,n=y.cc().$implicit;return y.cc().editTemplate(a,n.key)})),y.dc(2,"async"),y.Qb(3,"mat-icon"),y.Cc(4,"dashboard"),y.Pb(),y.Pb(),y.Qb(5,"button",41),y.Yb("click",(function(){y.rc(e);const a=t.$implicit,n=y.cc().$implicit;return y.cc().previewTemplate(a,n.key)})),y.dc(6,"async"),y.Ac(7,ge,2,0,"mat-icon",14),y.Ac(8,fe,2,0,"mat-icon",14),y.Pb(),y.Pb()}if(2&e){const e=t.$implicit,a=y.cc(2);y.wb(1),y.ic("disabled",y.ec(2,4,a.res.isLoading$)),y.wb(4),y.ic("disabled",y.ec(6,6,a.res.isLoading$)),y.wb(2),y.ic("ngIf",e.active-0==1),y.wb(1),y.ic("ngIf",e.active-0==0)}}function Pe(e,t){1&e&&y.Lb(0,"mat-header-row")}function we(e,t){1&e&&y.Lb(0,"mat-row")}function ye(e,t){if(1&e){const e=y.Rb();y.Qb(0,"mat-expansion-panel",19),y.Yb("opened",(function(){y.rc(e);const a=t.$implicit;return y.cc().expansionPanelOpen(a.key)})),y.Qb(1,"mat-expansion-panel-header"),y.Qb(2,"mat-panel-title",20),y.Cc(3),y.dc(4,"keyToLang"),y.Pb(),y.Pb(),y.Qb(5,"mat-table",21),y.Ob(6,22),y.Ac(7,ne,1,0,"mat-header-cell",23),y.Ac(8,ie,3,4,"mat-cell",24),y.Nb(),y.Ob(9,25),y.Ac(10,ce,2,0,"mat-header-cell",23),y.Ac(11,se,3,2,"mat-cell",24),y.Nb(),y.Ob(12,26),y.Ac(13,be,2,0,"mat-header-cell",23),y.Ac(14,pe,12,7,"mat-cell",27),y.Nb(),y.Ob(15,28),y.Ac(16,ue,2,0,"mat-header-cell",29),y.Ac(17,he,9,8,"mat-cell",30),y.Nb(),y.Ac(18,Pe,1,0,"mat-header-row",31),y.Ac(19,we,1,0,"mat-row",32),y.Pb(),y.Pb()}if(2&e){const e=t.$implicit,a=y.cc();y.ic("expanded",e.key===a.expansionPanelOpen()),y.wb(3),y.Ec(" ",y.ec(4,5,e.key)," "),y.wb(2),y.ic("dataSource",e.value),y.wb(13),y.ic("matHeaderRowDef",a.displayedColumns),y.wb(1),y.ic("matRowDefColumns",a.displayedColumns)}}function ve(e,t){1&e&&(y.Qb(0,"span"),y.Cc(1,"\xa0[Unedited]"),y.Pb())}function Oe(e,t){if(1&e){const e=y.Rb();y.Ob(0),y.Qb(1,"mat-toolbar",42),y.Qb(2,"mat-toolbar-row"),y.Qb(3,"span"),y.Cc(4),y.Pb(),y.Ac(5,ve,2,0,"span",14),y.Qb(6,"button",43),y.Yb("click",(function(){y.rc(e);const a=t.ngIf;return y.cc().openBuilderFromPreview(a)})),y.Cc(7," Edit it on builder "),y.Pb(),y.Pb(),y.Pb(),y.Lb(8,"ip-preview-template",44),y.Nb()}if(2&e){const e=t.ngIf;y.wb(4),y.Dc(e.name),y.wb(1),y.ic("ngIf",!e.is_edited),y.wb(3),y.ic("template",e.html)}}function Ce(e,t){if(1&e){const e=y.Rb();y.Ob(0),y.Qb(1,"mat-toolbar",42),y.Qb(2,"mat-toolbar-row"),y.Qb(3,"span"),y.Cc(4),y.Pb(),y.Qb(5,"div",45),y.Qb(6,"button",46),y.Yb("click",(function(){y.rc(e);const a=t.ngIf;return y.cc().saveEmail(a)})),y.Cc(7," Save "),y.Pb(),y.Qb(8,"button",46),y.Yb("click",(function(){y.rc(e);const a=t.ngIf;return y.cc().saveEmail(a,!0)})),y.Cc(9," Save and Close "),y.Pb(),y.Pb(),y.Pb(),y.Pb(),y.Qb(10,"ip-email-builder",47),y.Qb(11,"div",48),y.Qb(12,"button",46),y.Yb("click",(function(){y.rc(e);const a=t.ngIf;return y.cc().revertTemplateBack(a.isEdited)})),y.Cc(13," Restore template "),y.Pb(),y.Pb(),y.Pb(),y.Nb()}if(2&e){const e=t.ngIf;y.wb(4),y.Dc(e.name),y.wb(6),y.ic("email",e.email)}}let je=(()=>{class e{constructor(e,t,a,n){this.res=e,this.ngb=t,this.dialog=a,this.el=n,this.onDestroy$=new i.a,this.activeLanguage$=new c.a(null),this.previewTemplate$=new c.a(null),this.editTemplateObject$=new c.a(null),this.displayedColumns=["active","name","subject","actions"],this.languages$=this.res.getAllLanguages().pipe(Object(r.a)(e=>this.getActiveLanguage$.pipe(Object(m.a)(t=>e.filter(e=>![t].includes(e))))),Object(d.a)(this.onDestroy$)),this.getActiveLanguage$=this.activeLanguage$.pipe(Object(m.a)(e=>e||globalThis.NGB.activeLanguage),Object(d.a)(this.onDestroy$)),this.keyDowns$=Object(o.a)(this.el.nativeElement,"keydown").pipe(Object(p.a)(e=>{this.sidenav.opened&&e.stopImmediatePropagation()}),Object(d.a)(this.onDestroy$)),this.getTemplates$=this.getActiveLanguage$.pipe(Object(r.a)(e=>this.res.getTemplatesByLang(e)),Object(d.a)(this.onDestroy$)),this.getTemplateObject$=this.editTemplateObject$.pipe(Object(r.a)(e=>e?e.email?Object(l.a)(e):this.res.getTemplate(e.emailtemplateid).pipe(Object(m.a)(t=>Object.assign(Object.assign({},e),t))):Object(l.a)(null)),Object(r.a)(e=>e?this.res.getAllMergeFields(e.type).pipe(Object(p.a)(e=>{this.ngb.MergeTags=new Set(e.map(({key:e})=>e))}),Object(m.a)(()=>e),Object(p.a)(()=>{this.previewTemplate$.next(null),this.sidenav.open()})):Object(l.a)(null)),Object(d.a)(this.onDestroy$)),this.getPreviewTemplate$=this.previewTemplate$.pipe(Object(r.a)(e=>e&&this.res.getTemplateBody(e.id).pipe(Object(m.a)(t=>Object.assign(Object.assign({},t),e)),Object(p.a)(e=>{e&&(this.editTemplateObject$.next(null),this.sidenav.open())}))||Object(l.a)(null)),Object(d.a)(this.onDestroy$))}changeLanguage(e){this.activeLanguage$.next(e)}editTemplate(e,t){this.editTemplateObject$.next({emailtemplateid:e.emailtemplateid,type:t,name:e.name})}previewTemplate(e){this.previewTemplate$.next({id:e.emailtemplateid,name:e.name})}closeSidenav(e=!0){return Object(n.a)(this,void 0,void 0,(function*(){let t=!0;e&&this.ngb.hasChanges&&this.editTemplateObject$.getValue()&&(t=yield this.dialog.open(Y,{data:{type:"confirm"},width:"300px",maxWidth:"100%"}).afterClosed().pipe(Object(m.a)(Boolean)).toPromise()),t&&(yield this.sidenav.close(),this.editTemplateObject$.next(null)),this.previewTemplate$.next(null)}))}openBuilderFromPreview({id:e,type:t,name:a}){return Object(n.a)(this,void 0,void 0,(function*(){this.previewTemplate$.next(null),yield this.closeSidenav(),this.editTemplateObject$.next({emailtemplateid:e,type:t,name:a})}))}expansionPanelOpen(e){return e&&localStorage.setItem("expansionPanelOpened",e),localStorage.getItem("expansionPanelOpened")||"client"}saveEmail(e,t=!1){return Object(n.a)(this,void 0,void 0,(function*(){if(this.ngb.hasChanges){const a=new FormData,n=this.editTemplateObject$.getValue();a.append("emailtemplateid",n.emailtemplateid),this.ngb.saveEmail().pipe(Object(r.a)(({html:e})=>(a.append("emailObject",JSON.stringify(this.ngb.Email)),a.append("template",e),this.res.sendPostRequest(a,"update"))),Object(u.a)(e=>(console.error(e),this.ngb.notify("Something bad happened."),s.a)),Object(g.a)(1)).subscribe(({success:a})=>{a&&(e.isEdited=!0,n.updated_at=new Date,t?Object(b.a)(this.closeSidenav()).pipe(Object(f.a)(()=>this.ngb.notify("Email template has been saved successfully."))):this.ngb.notify("Email template has been saved successfully."))})}else t&&(yield this.closeSidenav()),this.ngb.notify("Email template has been saved successfully.")}))}changeActiveStatus({checked:e,source:t},a){return Object(n.a)(this,void 0,void 0,(function*(){const n=e?1:0,i=new FormData;i.append("emailtemplateid",a.emailtemplateid),i.append("active",String(n));try{(yield this.res.sendPostRequest(i,"changeActiveStatus").toPromise()).success?(a.active=n,a.updated_at=new Date):t.toggle()}catch(c){t.toggle()}}))}changeElementDetails(e){return Object(n.a)(this,void 0,void 0,(function*(){const t=yield this.dialog.open(Y,{data:{type:"edit",data:e,mergeFields:[]},width:"450px",maxWidth:"100%"}).afterClosed().pipe(Object(r.a)(e=>{if(!e)return Object(l.a)({success:!1});const t=new FormData(e);return this.res.sendPostRequest(t,"updateDetails")})).toPromise();t.success&&(e.subject=t.updates.subject,e.fromname=t.updates.fromname,e.updated_at=new Date,this.ngb.notify("The details have been saved."))}))}revertTemplateBack(e){if(e){const e=this.editTemplateObject$.getValue();this.dialog.open(Y,{data:{type:"confirm-revert"},width:"300px",maxWidth:"100%"}).afterClosed().pipe(Object(m.a)(Boolean),Object(r.a)(t=>t&&this.res.revertTemplate(e.emailtemplateid)||s.a),Object(p.a)(e=>this.ngb.Email=e.email),Object(p.a)(()=>delete e.updated_at),Object(g.a)(1)).toPromise()}else this.ngb.notify("You can't restore this template, as it's not edited.")}ngOnInit(){this.keyDowns$.subscribe()}ngOnDestroy(){this.onDestroy$.next(!0),this.onDestroy$.complete(),this.activeLanguage$.complete(),this.previewTemplate$.complete(),this.editTemplateObject$.complete()}}return e.\u0275fac=function(t){return new(t||e)(y.Kb(C),y.Kb(w.d),y.Kb(j.b),y.Kb(y.j))},e.\u0275cmp=y.Eb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var a;1&e&&y.Gc(W,!0),2&e&&y.nc(a=y.Zb())&&(t.sidenav=a.first)},decls:29,vars:21,consts:[[2,"width","100%",3,"backdropClick"],["fxLayout","column wrap","fxLayoutAlign","top center","fxLayoutGap","1rem",1,"mat-typography"],[1,"mat-elevation-z2"],["mode","indeterminate","style","position: absolute;",4,"ngIf"],["fxLayout","","fxLayoutGap","1rem",2,"margin-left","auto"],["mat-flat-button","","color","primary","class","capitalize",4,"ngIf"],["mat-flat-button","",3,"matMenuTriggerFor","disabled"],["langMenu","matMenu"],["matMenuContent",""],[2,"padding","1rem","max-width","1400px","width","100%","box-sizing","border-box"],["fxFlex",""],[3,"expanded","opened",4,"ngFor","ngForOf"],["position","end","disableClose","",2,"width","1200px","max-width","80%"],["sidenav",""],[4,"ngIf"],["mode","indeterminate",2,"position","absolute"],["mat-flat-button","","color","primary",1,"capitalize"],[4,"ngFor","ngForOf"],["mat-menu-item","",1,"capitalize",3,"click"],[3,"expanded","opened"],[1,"capitalize"],["fxFlex","",3,"dataSource"],["matColumnDef","active"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","name"],["matColumnDef","subject"],["class","subject-column","fxLayoutAlign","space-between center",4,"matCellDef"],["matColumnDef","actions"],["fxFlex","0 0 144px","fxLayoutAlign","flex-end center",4,"matHeaderCellDef"],["fxLayoutAlign","flex-end","fxFlex","0 0 auto",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["matTooltip","Change active status","matTooltipPosition","above","disableRipple","",3,"checked","disabled","change"],["fxLayoutAlign","space-between center",1,"subject-column"],["fxLayout","","fxLayoutAlign","center center","fxLayoutGap","0.5rem"],["matTooltip","Last updated","matTooltipPosition","above"],["mat-icon-button","","matTooltip","Edit email details","matTooltipPosition","left","aria-label","Edit email details","color","primary",3,"disabled","click"],["fxFlex","0 0 144px","fxLayoutAlign","flex-end center"],["fxLayoutAlign","flex-end","fxFlex","0 0 auto"],["mat-icon-button","","matTooltip","Open on builder","matTooltipPosition","above","aria-label","Open on builder","color","accent",3,"disabled","click"],["mat-icon-button","","matTooltip","Preview","matTooltipPosition","above","aria-label","Preview","color","accent",3,"disabled","click"],["color","primary"],["mat-flat-button","","color","accent",2,"margin-left","auto",3,"click"],[2,"height","100%","justify-content","center",3,"template"],["fxLayoutGap","0.5rem",2,"margin-left","auto"],["mat-flat-button","","color","accent",3,"click"],[2,"height","inherit",3,"email"],[1,"top-actions"]],template:function(e,t){if(1&e&&(y.Qb(0,"mat-sidenav-container",0),y.Yb("backdropClick",(function(){return t.closeSidenav()})),y.Qb(1,"mat-sidenav-content"),y.Qb(2,"div",1),y.Qb(3,"mat-toolbar",2),y.Ac(4,Z,1,0,"mat-progress-bar",3),y.dc(5,"async"),y.Qb(6,"mat-toolbar-row"),y.Qb(7,"h1"),y.Cc(8,"Email templates"),y.Pb(),y.Qb(9,"div",4),y.Ac(10,ee,2,1,"button",5),y.dc(11,"async"),y.Qb(12,"button",6),y.dc(13,"async"),y.Cc(14," Other languages "),y.Pb(),y.Qb(15,"mat-menu",null,7),y.Ac(17,ae,2,3,"ng-template",8),y.Pb(),y.Pb(),y.Pb(),y.Pb(),y.Qb(18,"div",9),y.Qb(19,"mat-accordion",10),y.Ac(20,ye,20,7,"mat-expansion-panel",11),y.dc(21,"keyvalue"),y.dc(22,"async"),y.Pb(),y.Pb(),y.Pb(),y.Pb(),y.Qb(23,"mat-sidenav",12,13),y.Ac(25,Oe,9,3,"ng-container",14),y.dc(26,"async"),y.Ac(27,Ce,14,2,"ng-container",14),y.dc(28,"async"),y.Pb(),y.Pb()),2&e){const e=y.oc(16);y.wb(4),y.ic("ngIf",y.ec(5,7,t.res.isLoading$)),y.wb(6),y.ic("ngIf",y.ec(11,9,t.getActiveLanguage$)),y.wb(2),y.ic("matMenuTriggerFor",e)("disabled",y.ec(13,11,t.res.isLoading$)),y.wb(8),y.ic("ngForOf",y.ec(21,13,y.ec(22,15,t.getTemplates$))),y.wb(5),y.ic("ngIf",y.ec(26,17,t.getPreviewTemplate$)),y.wb(2),y.ic("ngIf",y.ec(28,19,t.getTemplateObject$))}},directives:[G.b,G.c,x.c,x.b,x.d,q.a,Q.i,q.c,$.a,B.d,B.e,B.a,z.a,x.a,Q.h,G.a,V.a,B.b,z.c,z.e,z.f,K.j,K.c,K.e,K.b,K.g,K.i,K.d,K.a,X.a,J.a,U.a,K.f,K.h,w.e,w.b],pipes:[Q.a,Q.e,H,Q.d],styles:["[_nghost-%COMP%]{display:block;height:inherit}[_nghost-%COMP%], mat-sidenav-container[_ngcontent-%COMP%]{min-height:inherit}mat-header-row[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:first-child{max-width:84px}mat-cell[_ngcontent-%COMP%]:first-child{max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content;padding-right:24px}mat-cell[_ngcontent-%COMP%]:nth-child(2), mat-header-row[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:nth-child(2){max-width:400px;border-right:1px solid #e0e0e0}mat-cell[_ngcontent-%COMP%]:nth-child(3), mat-header-row[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:nth-child(3){padding-left:24px}.subject-column[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:0;transition:all .3s ease-in-out;will-change:opacity}.subject-column[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:1}.subject-column[_ngcontent-%COMP%]:hover   button[_ngcontent-%COMP%]:not(:hover){opacity:.5}.mat-drawer-container[_ngcontent-%COMP%]{background:transparent;height:inherit}.force-select[_ngcontent-%COMP%]{-webkit-user-select:all;-moz-user-select:all;-ms-user-select:all;user-select:all;margin-bottom:1rem}"],changeDetection:0}),e})()}}]);