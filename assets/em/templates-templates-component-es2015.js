(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{BsGo:function(e,t,a){"use strict";a.r(t),a.d(t,"TemplatesComponent",(function(){return ke}));var n=a("XNiG"),i=a("2Vo4"),c=a("xgIS"),o=a("LRne"),s=a("cp0P"),l=a("itXk"),b=a("Cfvw"),r=a("EY2u"),m=a("pLZG"),d=a("XqQ8"),p=a("lJxs"),u=a("vkgz"),g=a("1G5W"),h=a("eIep"),f=a("IzEk"),w=a("JIr8"),P=a("nYR2"),O=a("uSps"),v=a("z6cu"),y=a("UXun"),C=a("fXoL"),j=a("tk/3"),Q=a("dNgK");let x=(()=>{class e{constructor(e,t){this.http=e,this.matSnack=t,this._isLoading$=new n.a,this.isLoading$=this._isLoading$.asObservable()}httpRequest(e,t={},a="get",n){return this._isLoading$.next(!0),this.matSnack.open("Please wait..."),this.http.request(a,`${globalThis.NGB.baseUrl}/${e}`,{params:t,body:n,responseType:"json"}).pipe(Object(w.a)(e=>(e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):(console.error(`Backend returned code ${e.status}`),this.matSnack.open(`Something bad happened; please try again later. "Error Status ${e.status}".`,"Close",{announcementMessage:"Something bad happened; please try again later."})),console.error(e),Object(v.a)(new Error("Something bad happened; please try again later.")))),Object(u.a)(()=>this.matSnack.dismiss()),Object(P.a)(()=>this._isLoading$.next(!1)))}getTemplatesByLang(e){return this.httpRequest("templates",{language:e})}getTemplateBody(e){return this.httpRequest("getEmailTemplate",{id:e})}getTemplate(e){return this.httpRequest("getTemplate",{id:e})}revertTemplate(e){return this.sendPostRequest(new FormData,`revertTemplate/${e}`).pipe(Object(p.a)(e=>({isEdited:!1,email:new O.a({structures:[new O.f("cols_1",[[new O.g(e.message)]])]})})))}getAllLanguages(){return this.httpRequest("languages").pipe(Object(y.a)(),Object(w.a)(()=>Object(o.a)([])))}getAllMergeFields(e){return this.httpRequest("mergeFields",{type:e}).pipe(Object(w.a)(()=>Object(o.a)([])))}sendPostRequest(e=new FormData,t){const{token:a,name:n}=globalThis.NGB.csrf;return e.append(n,a),this.httpRequest(t,{},"post",e)}}return e.\u0275fac=function(t){return new(t||e)(C.Ub(j.a),C.Ub(Q.a))},e.\u0275prov=C.Gb({token:e,factory:e.\u0275fac,providedIn:"any"}),e})();var $=a("0IaG"),k=a("ofXK"),L=a("XiUz"),T=a("bTqV"),A=a("3Pt+"),D=a("kmnG"),I=a("qFsG"),S=a("MutI"),F=a("f0Cb");function M(e,t){1&e&&(C.Ob(0),C.Qb(1,"h2",2),C.Cc(2,"Are you sure?"),C.Pb(),C.Qb(3,"mat-dialog-content"),C.Cc(4," You are about to close the builder, but there're unsaved changes, which will be lost. Are you sure? "),C.Pb(),C.Qb(5,"mat-dialog-actions",3),C.Qb(6,"button",4),C.Cc(7," No, Go back! "),C.Pb(),C.Qb(8,"button",5),C.Cc(9," Yes, Close it. "),C.Pb(),C.Pb(),C.Nb()),2&e&&(C.wb(8),C.ic("mat-dialog-close",!0))}function _(e,t){1&e&&(C.Ob(0),C.Qb(1,"h2",2),C.Cc(2,"Are you sure?"),C.Pb(),C.Qb(3,"mat-dialog-content"),C.Qb(4,"p"),C.Cc(5,"You are about to restore this template to default Perfex template, all additional changes will be lost."),C.Pb(),C.Qb(6,"p"),C.Qb(7,"strong"),C.Qb(8,"strong"),C.Cc(9,"This will affect only template body, not name nor subject."),C.Pb(),C.Pb(),C.Pb(),C.Qb(10,"p"),C.Qb(11,"strong"),C.Cc(12,"Are you sure?"),C.Pb(),C.Pb(),C.Pb(),C.Qb(13,"mat-dialog-actions",3),C.Qb(14,"button",4),C.Cc(15," No, Go back! "),C.Pb(),C.Qb(16,"button",5),C.Cc(17," Yes, Restore it. "),C.Pb(),C.Pb(),C.Nb()),2&e&&(C.wb(16),C.ic("mat-dialog-close",!0))}function E(e,t){if(1&e&&(C.Qb(0,"mat-list-item"),C.Qb(1,"div",16),C.Qb(2,"span"),C.Cc(3),C.Pb(),C.Qb(4,"code"),C.Cc(5),C.Pb(),C.Pb(),C.Pb()),2&e){const e=C.cc().$implicit;C.wb(3),C.Dc(e.name),C.wb(2),C.Dc(e.key)}}function R(e,t){1&e&&C.Lb(0,"mat-divider")}function N(e,t){if(1&e&&(C.Ob(0),C.Ac(1,E,6,2,"mat-list-item",1),C.Ac(2,R,1,0,"mat-divider",1),C.Nb()),2&e){const e=t.$implicit;C.wb(1),C.ic("ngIf",e.key),C.wb(1),C.ic("ngIf",e.key)}}function G(e,t){if(1&e&&(C.Qb(0,"mat-list",14),C.Ac(1,N,3,2,"ng-container",15),C.Pb()),2&e){const e=C.cc(2);C.wb(1),C.ic("ngForOf",e.data.mergeFields)}}function Y(e,t){if(1&e&&(C.Ob(0),C.Qb(1,"h2",2),C.Cc(2,"Edit details"),C.Pb(),C.Qb(3,"mat-dialog-content"),C.Qb(4,"form",null,6),C.Lb(6,"input",7),C.Qb(7,"mat-form-field",8),C.Qb(8,"mat-label"),C.Cc(9,"From Name"),C.Pb(),C.Lb(10,"input",9),C.Pb(),C.Qb(11,"mat-form-field",8),C.Qb(12,"mat-label"),C.Cc(13,"Subject"),C.Pb(),C.Lb(14,"input",10),C.Pb(),C.Pb(),C.Ac(15,G,2,1,"mat-list",11),C.Pb(),C.Qb(16,"mat-dialog-actions",3),C.Qb(17,"button",12),C.Cc(18," Cancel "),C.Pb(),C.Qb(19,"button",13),C.Cc(20," Save "),C.Pb(),C.Pb(),C.Nb()),2&e){const e=C.oc(5),t=C.cc();C.wb(6),C.ic("value",t.data.data.emailtemplateid),C.wb(4),C.ic("value",t.data.data.fromname),C.wb(4),C.ic("value",t.data.data.subject),C.wb(1),C.ic("ngIf",t.data.mergeFields),C.wb(4),C.ic("disabled",!t.checkValidity(e))("mat-dialog-close",e)}}function q(e,t){if(1&e&&(C.Ob(0),C.Qb(1,"h2",2),C.Cc(2,"Send test email"),C.Pb(),C.Qb(3,"mat-dialog-content"),C.Lb(4,"form",null,17),C.Pb(),C.Qb(6,"mat-dialog-actions",3),C.Qb(7,"button",4),C.Cc(8," No, Go back! "),C.Pb(),C.Qb(9,"button",5),C.Cc(10," Yes, Close it. "),C.Pb(),C.Pb(),C.Nb()),2&e){const e=C.oc(5);C.wb(9),C.ic("mat-dialog-close",e)}}let B=(()=>{class e{constructor(e){this.data=e}checkValidity(e){return e.checkValidity()}}return e.\u0275fac=function(t){return new(t||e)(C.Kb($.a))},e.\u0275cmp=C.Eb({type:e,selectors:[["app-modal-dialog"]],decls:5,vars:4,consts:[[1,"mat-typography"],[4,"ngIf"],["mat-dialog-title",""],["fxLayoutAlign","space-between center"],["mat-button","","color","warn","cdkFocusInitial","","mat-dialog-close",""],["mat-button","",3,"mat-dialog-close"],["form",""],["type","hidden","name","emailtemplateid",3,"value"],["appearance","fill"],["matInput","","name","fromname","required","","type","text",3,"value"],["matInput","","name","subject","required","","type","text",3,"value"],["dense","",4,"ngIf"],["mat-button","","mat-dialog-close",""],["mat-button","","color","primary","cdkFocusInitial","",3,"disabled","mat-dialog-close"],["dense",""],[4,"ngFor","ngForOf"],["fxFlex","","fxLayout","","fxLayoutAlign","space-between center"],["form","ngForm"]],template:function(e,t){1&e&&(C.Qb(0,"div",0),C.Ac(1,M,10,1,"ng-container",1),C.Ac(2,_,18,1,"ng-container",1),C.Ac(3,Y,21,6,"ng-container",1),C.Ac(4,q,11,1,"ng-container",1),C.Pb()),2&e&&(C.wb(1),C.ic("ngIf","confirm"===t.data.type),C.wb(1),C.ic("ngIf","confirm-revert"===t.data.type),C.wb(1),C.ic("ngIf","edit"===t.data.type),C.wb(1),C.ic("ngIf","test-email"===t.data.type))},directives:[k.i,$.h,$.e,$.c,L.b,T.a,$.d,A.n,A.i,A.j,D.b,D.f,I.a,S.a,k.h,S.c,L.a,L.c,F.a],styles:["[_nghost-%COMP%]{display:block}mat-form-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;height:auto}mat-list[_ngcontent-%COMP%]{max-height:300px;overflow:auto}mat-list[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{-webkit-user-select:all;-moz-user-select:all;-ms-user-select:all;user-select:all}"]}),e})();var z=a("XhcP"),U=a("/t3+"),X=a("STbY"),K=a("7EHt"),J=a("bv9b"),H=a("+0xr"),V=a("1jcm"),W=a("Qu3c"),Z=a("NFeN");let ee=(()=>{class e{transform(e,...t){return e.split("_").join(" ")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=C.Jb({name:"keyToLang",type:e,pure:!0}),e})();const te=["sidenav"];function ae(e,t){1&e&&C.Lb(0,"mat-progress-bar",14)}function ne(e,t){if(1&e&&(C.Qb(0,"button",15),C.Cc(1),C.Pb()),2&e){const e=t.ngIf;C.wb(1),C.Ec(" ",e," ")}}function ie(e,t){if(1&e){const e=C.Rb();C.Ob(0),C.Qb(1,"button",18),C.Yb("click",(function(){C.rc(e);const a=t.$implicit;return C.cc(3).changeLanguage(a)})),C.Cc(2),C.dc(3,"keyToLang"),C.Pb(),C.Nb()}if(2&e){const e=t.$implicit;C.wb(2),C.Ec(" ",C.ec(3,1,e)," ")}}function ce(e,t){if(1&e&&C.Ac(0,ie,4,3,"ng-container",17),2&e){const e=C.cc().ngIf;C.ic("ngForOf",e)}}function oe(e,t){1&e&&C.Ac(0,ce,1,1,"ng-template",16)}function se(e,t){1&e&&C.Lb(0,"mat-header-cell")}function le(e,t){if(1&e){const e=C.Rb();C.Qb(0,"mat-cell"),C.Qb(1,"mat-slide-toggle",33),C.Yb("change",(function(a){C.rc(e);const n=t.$implicit;return C.cc(2).changeActiveStatus(a,n)})),C.dc(2,"async"),C.Pb(),C.Pb()}if(2&e){const e=t.$implicit,a=C.cc(2);C.wb(1),C.ic("checked",e.active-0==1)("disabled",C.ec(2,2,a.res.isLoading$))}}function be(e,t){1&e&&(C.Qb(0,"mat-header-cell"),C.Cc(1,"Name"),C.Pb())}function re(e,t){if(1&e&&(C.Qb(0,"span"),C.Cc(1),C.Pb()),2&e){const e=C.cc().$implicit;C.wb(1),C.Dc(e.name)}}function me(e,t){if(1&e&&(C.Qb(0,"del"),C.Cc(1),C.Pb()),2&e){const e=C.cc().$implicit;C.wb(1),C.Dc(e.name)}}function de(e,t){if(1&e&&(C.Qb(0,"mat-cell"),C.Ac(1,re,2,1,"span",8),C.Ac(2,me,2,1,"del",8),C.Pb()),2&e){const e=t.$implicit;C.wb(1),C.ic("ngIf","1"===e.active),C.wb(1),C.ic("ngIf","1"!==e.active)}}function pe(e,t){1&e&&(C.Qb(0,"mat-header-cell"),C.Cc(1," From Name > Subject "),C.Pb())}function ue(e,t){if(1&e&&(C.Qb(0,"span"),C.Cc(1),C.Pb()),2&e){const e=C.cc().$implicit;C.wb(1),C.Ec(" ",e.fromname," > ")}}function ge(e,t){if(1&e){const e=C.Rb();C.Qb(0,"mat-cell",34),C.Qb(1,"div"),C.Ac(2,ue,2,1,"span",8),C.Cc(3),C.Pb(),C.Qb(4,"div",35),C.Qb(5,"span",36),C.Cc(6),C.dc(7,"date"),C.Pb(),C.Qb(8,"button",37),C.Yb("click",(function(){C.rc(e);const a=t.$implicit,n=C.cc().$implicit;return C.cc().changeElementDetails(a,n.key)})),C.dc(9,"async"),C.Qb(10,"mat-icon"),C.Cc(11,"edit"),C.Pb(),C.Pb(),C.Pb(),C.Pb()}if(2&e){const e=t.$implicit,a=C.cc(2);C.wb(2),C.ic("ngIf",e.fromname),C.wb(1),C.Ec(" ",e.subject," "),C.wb(3),C.Ec(" ",C.fc(7,4,a.getUpdatedDate(e),"short")," "),C.wb(2),C.ic("disabled",C.ec(9,7,a.res.isLoading$))}}function he(e,t){1&e&&(C.Qb(0,"mat-header-cell",38),C.Cc(1," Actions "),C.Pb())}function fe(e,t){1&e&&(C.Qb(0,"mat-icon"),C.Cc(1," visibility "),C.Pb())}function we(e,t){1&e&&(C.Qb(0,"mat-icon"),C.Cc(1," visibility_off "),C.Pb())}function Pe(e,t){if(1&e){const e=C.Rb();C.Qb(0,"mat-cell",39),C.Qb(1,"button",40),C.Yb("click",(function(){C.rc(e);const a=t.$implicit,n=C.cc().$implicit;return C.cc().editTemplate(a,n.key)})),C.dc(2,"async"),C.Qb(3,"mat-icon"),C.Cc(4,"dashboard"),C.Pb(),C.Pb(),C.Qb(5,"button",41),C.Yb("click",(function(){C.rc(e);const a=t.$implicit,n=C.cc().$implicit;return C.cc().previewTemplate(a,n.key)})),C.dc(6,"async"),C.Ac(7,fe,2,0,"mat-icon",8),C.Ac(8,we,2,0,"mat-icon",8),C.Pb(),C.Pb()}if(2&e){const e=t.$implicit,a=C.cc(2);C.wb(1),C.ic("disabled",C.ec(2,4,a.res.isLoading$)),C.wb(4),C.ic("disabled",C.ec(6,6,a.res.isLoading$)),C.wb(2),C.ic("ngIf",e.active-0==1),C.wb(1),C.ic("ngIf",e.active-0==0)}}function Oe(e,t){1&e&&C.Lb(0,"mat-header-row")}function ve(e,t){1&e&&C.Lb(0,"mat-row")}function ye(e,t){if(1&e){const e=C.Rb();C.Qb(0,"mat-expansion-panel",19),C.Yb("opened",(function(){C.rc(e);const a=t.$implicit;return C.cc().expansionPanelOpen(a.key)})),C.Qb(1,"mat-expansion-panel-header"),C.Qb(2,"mat-panel-title",20),C.Cc(3),C.dc(4,"keyToLang"),C.Pb(),C.Pb(),C.Qb(5,"mat-table",21),C.Ob(6,22),C.Ac(7,se,1,0,"mat-header-cell",23),C.Ac(8,le,3,4,"mat-cell",24),C.Nb(),C.Ob(9,25),C.Ac(10,be,2,0,"mat-header-cell",23),C.Ac(11,de,3,2,"mat-cell",24),C.Nb(),C.Ob(12,26),C.Ac(13,pe,2,0,"mat-header-cell",23),C.Ac(14,ge,12,9,"mat-cell",27),C.Nb(),C.Ob(15,28),C.Ac(16,he,2,0,"mat-header-cell",29),C.Ac(17,Pe,9,8,"mat-cell",30),C.Nb(),C.Ac(18,Oe,1,0,"mat-header-row",31),C.Ac(19,ve,1,0,"mat-row",32),C.Pb(),C.Pb()}if(2&e){const e=t.$implicit,a=C.cc();C.ic("expanded",e.key===a.expansionPanelOpen()),C.wb(3),C.Ec(" ",C.ec(4,5,e.key)," "),C.wb(2),C.ic("dataSource",e.value),C.wb(13),C.ic("matHeaderRowDef",a.displayedColumns),C.wb(1),C.ic("matRowDefColumns",a.displayedColumns)}}function Ce(e,t){1&e&&(C.Qb(0,"span"),C.Cc(1,"\xa0[Unedited]"),C.Pb())}function je(e,t){if(1&e){const e=C.Rb();C.Ob(0),C.Qb(1,"mat-toolbar",42),C.Qb(2,"mat-toolbar-row"),C.Qb(3,"span"),C.Cc(4),C.Pb(),C.Ac(5,Ce,2,0,"span",8),C.Qb(6,"button",43),C.Yb("click",(function(){C.rc(e);const t=C.cc().ngIf;return C.cc().openBuilderFromPreview(t)})),C.Cc(7," Edit it on builder "),C.Pb(),C.Pb(),C.Pb(),C.Lb(8,"ip-preview-template",44),C.Nb()}if(2&e){const e=C.cc().ngIf;C.wb(4),C.Dc(e.name),C.wb(1),C.ic("ngIf",!e.is_edited),C.wb(3),C.ic("template",e.html)}}function Qe(e,t){if(1&e){const e=C.Rb();C.Ob(0),C.Qb(1,"mat-toolbar",42),C.Qb(2,"mat-toolbar-row"),C.Qb(3,"span"),C.Cc(4),C.Pb(),C.Qb(5,"div",45),C.Qb(6,"button",46),C.Yb("click",(function(){return C.rc(e),C.cc(2).backdropClick()})),C.Cc(7," Close Builder "),C.Pb(),C.Pb(),C.Pb(),C.Pb(),C.Qb(8,"ip-email-builder",47),C.Qb(9,"div",48),C.Qb(10,"button",49),C.Yb("click",(function(){C.rc(e);const t=C.cc().ngIf;return C.cc().saveEmail(t)})),C.Cc(11," Save "),C.Pb(),C.Qb(12,"button",46),C.Yb("click",(function(){return C.rc(e),C.cc(2).revertTemplateBack()})),C.Cc(13," Revert Template "),C.Pb(),C.Pb(),C.Pb(),C.Nb()}if(2&e){const e=C.cc().ngIf;C.wb(4),C.Dc(e.name),C.wb(4),C.ic("email",e.template)}}function xe(e,t){if(1&e&&(C.Ob(0),C.Ac(1,je,9,3,"ng-container",8),C.Ac(2,Qe,14,2,"ng-container",8),C.Nb()),2&e){const e=t.ngIf;C.wb(1),C.ic("ngIf",e.html),C.wb(1),C.ic("ngIf",e.template)}}function $e(){return Object(m.a)(e=>null!==e)}let ke=(()=>{class e{constructor(e,t,a,b){this.res=e,this.ngb=t,this.dialog=a,this.el=b,this.onDestroy$=new n.a,this.activeLanguage$=new i.a(globalThis.NGB.activeLanguage),this.previewTemplate$=new i.a(null),this.editTemplateObject$=new i.a(null),this.updatedStore=new Map,this.removeUpdatedStore=new Set,this.displayedColumns=["active","name","subject","actions"],this.languages$=this.res.getAllLanguages().pipe(Object(d.a)(e=>this.getActiveLanguage$.pipe(Object(p.a)(t=>[...e,globalThis.NGB.activeLanguage].filter(e=>e!==t).sort())))),this.getActiveLanguage$=this.activeLanguage$.asObservable(),this.keyDowns$=Object(c.a)(this.el.nativeElement,"keydown").pipe(Object(u.a)(e=>{this.sidenav.opened&&e.stopImmediatePropagation()}),Object(g.a)(this.onDestroy$)),this.getTemplates$=this.getActiveLanguage$.pipe(Object(d.a)(e=>this.res.getTemplatesByLang(e)),Object(g.a)(this.onDestroy$)),this.getTemplateObject$=this.editTemplateObject$.pipe(Object(d.a)(e=>e?Object(s.a)([this.res.getTemplate(e.id),this.res.getAllMergeFields(e.type)]).pipe(Object(p.a)(([t,a])=>(this.ngb.MergeTags=new Set(a.map(({key:e})=>e)),Object.assign(Object.assign({},e),{template:new O.a(Object.assign({structures:[new O.f("cols_1",[[new O.g(t.template.message)]])]},t.template))}))),Object(u.a)(()=>{this.previewTemplate$.next(null),this.sidenav.open()})):Object(o.a)(null)),Object(g.a)(this.onDestroy$)),this.getPreviewTemplate$=this.previewTemplate$.pipe(Object(d.a)(e=>e?this.res.getTemplateBody(e.id).pipe(Object(p.a)(t=>Object.assign(Object.assign({},e),t)),Object(u.a)(()=>{this.editTemplateObject$.next(null),this.sidenav.open()})):Object(o.a)(null)),Object(g.a)(this.onDestroy$)),this.sidenavDetails$=Object(l.a)([this.getTemplateObject$,this.getPreviewTemplate$]).pipe(Object(p.a)(([e,t])=>e||t))}changeLanguage(e){this.activeLanguage$.next(e)}editTemplate(e,t){this.editTemplateObject$.next({id:e.emailtemplateid,type:t,name:e.name})}previewTemplate(e,t){this.previewTemplate$.next({id:e.emailtemplateid,type:t,name:e.name})}closeSidenav(e=!0){return Object(o.a)("").pipe(Object(h.a)(()=>e&&this.ngb.hasChanges?this.dialog.open(B,{data:{type:"confirm"},width:"300px",maxWidth:"100%"}).afterClosed().pipe(Object(p.a)(Boolean)):Object(o.a)(!0)),Object(d.a)(e=>e?Object(b.a)(this.sidenav.close()).pipe(Object(p.a)(()=>!0)):Object(o.a)(!1)))}backdropClick(){return this.closeSidenav().pipe(Object(f.a)(1)).subscribe()}getUpdatedDate(e){const{emailtemplateid:t}=e;return this.removeUpdatedStore.has(t)?null:this.updatedStore.get(t)||e.updated_at||null}openBuilderFromPreview({id:e,name:t,type:a}){return this.closeSidenav(!1).pipe(Object(f.a)(1)).subscribe(n=>{n&&this.editTemplateObject$.next({id:e,name:t,type:a})})}expansionPanelOpen(e){return e&&localStorage.setItem("expansionPanelOpened",e),localStorage.getItem("expansionPanelOpened")||"client"}saveEmail(e,t=!1){const a=new FormData;return this.editTemplateObject$.pipe($e(),Object(d.a)(e=>(a.append("emailtemplateid",e.id),this.ngb.saveEmail().pipe(Object(d.a)(({html:e})=>(a.append("emailObject",JSON.stringify(this.ngb.Email)),a.append("template",e),this.res.sendPostRequest(a,"update"))),Object(w.a)(e=>(console.error(e),this.ngb.notify("Something bad happened."),r.a)),Object(P.a)(()=>this.updatedStore.set(e.id,new Date))))),Object(d.a)(({success:e})=>e&&t?this.closeSidenav(!1):Object(o.a)(e)),Object(f.a)(1)).subscribe(t=>{t&&(e.isEdited=!0,this.ngb.notify("Email template has been saved successfully."))})}changeActiveStatus({checked:e,source:t},a){const n=e?1:0,i=new FormData;return i.append("emailtemplateid",a.emailtemplateid),i.append("active",String(n)),this.res.sendPostRequest(i,"changeActiveStatus").pipe(Object(w.a)(()=>(t.toggle(),r.a)),Object(f.a)(1)).subscribe(({success:e})=>{e?(a.active=n,this.updatedStore.set(a.emailtemplateid,new Date)):t.toggle()})}changeElementDetails(e,t){return this.res.getAllMergeFields(t).pipe(Object(h.a)(t=>this.dialog.open(B,{data:{type:"edit",data:e,mergeFields:t},width:"450px",maxWidth:"100%"}).afterClosed()),Object(d.a)(e=>{if(!e)return Object(o.a)({success:!1,updates:null});const t=new FormData(e);return this.res.sendPostRequest(t,"updateDetails")})).subscribe(({success:t,updates:a})=>{t&&a&&(e.subject=a.subject,e.fromname=a.fromname,this.updatedStore.set(e.emailtemplateid,new Date),this.ngb.notify("The details have been saved."))})}revertTemplateBack(){return this.editTemplateObject$.pipe($e(),Object(h.a)(({id:e})=>this.dialog.open(B,{data:{type:"confirm-revert"},width:"300px",maxWidth:"100%"}).afterClosed().pipe(Object(p.a)(Boolean),Object(m.a)(e=>e),Object(d.a)(()=>this.res.revertTemplate(e).pipe(Object(P.a)(()=>{this.updatedStore.delete(e),this.removeUpdatedStore.add(e)}))))),Object(f.a)(1)).subscribe(({email:e})=>{this.ngb.Email=e})}ngOnInit(){this.keyDowns$.subscribe()}ngOnDestroy(){this.onDestroy$.next(!0),this.onDestroy$.complete(),this.activeLanguage$.complete(),this.previewTemplate$.complete(),this.editTemplateObject$.complete(),this.updatedStore.clear(),this.removeUpdatedStore.clear()}}return e.\u0275fac=function(t){return new(t||e)(C.Kb(x),C.Kb(O.d),C.Kb($.b),C.Kb(C.j))},e.\u0275cmp=C.Eb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var a;1&e&&C.Gc(te,!0),2&e&&C.nc(a=C.Zb())&&(t.sidenav=a.first)},decls:28,vars:21,consts:[[2,"width","100%",3,"backdropClick"],["fxLayout","column wrap","fxLayoutAlign","top center","fxLayoutGap","1rem",1,"mat-typography"],[1,"mat-elevation-z2"],["mode","indeterminate","style","position: absolute;",4,"ngIf"],["fxLayout","","fxLayoutGap","1rem",2,"margin-left","auto"],["mat-flat-button","","color","primary","class","capitalize",4,"ngIf"],["mat-flat-button","",3,"matMenuTriggerFor","disabled"],["langMenu","matMenu"],[4,"ngIf"],[2,"padding","1rem","max-width","1400px","width","100%","box-sizing","border-box"],["fxFlex",""],[3,"expanded","opened",4,"ngFor","ngForOf"],["position","end","disableClose","",2,"width","1200px","max-width","80%"],["sidenav",""],["mode","indeterminate",2,"position","absolute"],["mat-flat-button","","color","primary",1,"capitalize"],["matMenuContent",""],[4,"ngFor","ngForOf"],["mat-menu-item","",1,"capitalize",3,"click"],[3,"expanded","opened"],[1,"capitalize"],["fxFlex","",3,"dataSource"],["matColumnDef","active"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","name"],["matColumnDef","subject"],["class","subject-column","fxLayoutAlign","space-between center",4,"matCellDef"],["matColumnDef","actions"],["fxFlex","0 0 144px","fxLayoutAlign","flex-end center",4,"matHeaderCellDef"],["fxLayoutAlign","flex-end","fxFlex","0 0 auto",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["matTooltip","Change active status","matTooltipPosition","above","disableRipple","",3,"checked","disabled","change"],["fxLayoutAlign","space-between center",1,"subject-column"],["fxLayout","","fxLayoutAlign","center center","fxLayoutGap","0.5rem"],["matTooltip","Last updated","matTooltipPosition","above"],["mat-icon-button","","matTooltip","Edit email details","matTooltipPosition","left","aria-label","Edit email details","color","primary",3,"disabled","click"],["fxFlex","0 0 144px","fxLayoutAlign","flex-end center"],["fxLayoutAlign","flex-end","fxFlex","0 0 auto"],["mat-icon-button","","matTooltip","Open on builder","matTooltipPosition","above","aria-label","Open on builder","color","accent",3,"disabled","click"],["mat-icon-button","","matTooltip","Preview","matTooltipPosition","above","aria-label","Preview","color","accent",3,"disabled","click"],["color","primary"],["mat-flat-button","","color","accent",2,"margin-left","auto",3,"click"],[2,"height","100%","justify-content","center",3,"template"],["fxLayoutGap","0.5rem",2,"margin-left","auto"],["mat-flat-button","","color","accent",3,"click"],[2,"height","inherit",3,"email"],["fxLayoutGap","0.5rem",1,"top-actions"],["mat-flat-button","","color","primary",3,"click"]],template:function(e,t){if(1&e&&(C.Qb(0,"mat-sidenav-container",0),C.Yb("backdropClick",(function(){return t.backdropClick()})),C.Qb(1,"mat-sidenav-content"),C.Qb(2,"div",1),C.Qb(3,"mat-toolbar",2),C.Ac(4,ae,1,0,"mat-progress-bar",3),C.dc(5,"async"),C.Qb(6,"mat-toolbar-row"),C.Qb(7,"h1"),C.Cc(8,"Email templates"),C.Pb(),C.Qb(9,"div",4),C.Ac(10,ne,2,1,"button",5),C.dc(11,"async"),C.Qb(12,"button",6),C.dc(13,"async"),C.Cc(14," Other languages "),C.Pb(),C.Qb(15,"mat-menu",null,7),C.Ac(17,oe,1,0,void 0,8),C.dc(18,"async"),C.Pb(),C.Pb(),C.Pb(),C.Pb(),C.Qb(19,"div",9),C.Qb(20,"mat-accordion",10),C.Ac(21,ye,20,7,"mat-expansion-panel",11),C.dc(22,"keyvalue"),C.dc(23,"async"),C.Pb(),C.Pb(),C.Pb(),C.Pb(),C.Qb(24,"mat-sidenav",12,13),C.Ac(26,xe,3,2,"ng-container",8),C.dc(27,"async"),C.Pb(),C.Pb()),2&e){const e=C.oc(16);C.wb(4),C.ic("ngIf",C.ec(5,7,t.res.isLoading$)),C.wb(6),C.ic("ngIf",C.ec(11,9,t.getActiveLanguage$)),C.wb(2),C.ic("matMenuTriggerFor",e)("disabled",C.ec(13,11,t.res.isLoading$)),C.wb(5),C.ic("ngIf",C.ec(18,13,t.languages$)),C.wb(4),C.ic("ngForOf",C.ec(22,15,C.ec(23,17,t.getTemplates$))),C.wb(5),C.ic("ngIf",C.ec(27,19,t.sidenavDetails$))}},directives:[z.b,z.c,L.c,L.b,L.d,U.a,k.i,U.c,T.a,X.d,X.e,K.a,L.a,k.h,z.a,J.a,X.a,X.b,K.c,K.e,K.f,H.j,H.c,H.e,H.b,H.g,H.i,H.d,H.a,V.a,W.a,Z.a,H.f,H.h,O.e,O.b],pipes:[k.a,k.e,ee,k.d],styles:["[_nghost-%COMP%]{display:block;height:inherit}[_nghost-%COMP%], mat-sidenav-container[_ngcontent-%COMP%]{min-height:inherit}mat-header-row[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:first-child{max-width:84px}mat-cell[_ngcontent-%COMP%]:first-child{max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content;padding-right:24px}mat-cell[_ngcontent-%COMP%]:nth-child(2), mat-header-row[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:nth-child(2){max-width:400px;border-right:1px solid #e0e0e0}mat-cell[_ngcontent-%COMP%]:nth-child(3), mat-header-row[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:nth-child(3){padding-left:24px}.subject-column[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:0;transition:all .3s ease-in-out;will-change:opacity}.subject-column[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:1}.subject-column[_ngcontent-%COMP%]:hover   button[_ngcontent-%COMP%]:not(:hover){opacity:.5}.mat-drawer-container[_ngcontent-%COMP%]{background:transparent;height:inherit}.force-select[_ngcontent-%COMP%]{-webkit-user-select:all;-moz-user-select:all;-ms-user-select:all;user-select:all;margin-bottom:1rem}"],changeDetection:0}),e})()}}]);