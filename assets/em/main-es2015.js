(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,a){e.exports=a("zUnb")},crnd:function(e,t){function a(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id="crnd"},zUnb:function(e,t,a){"use strict";a.r(t);var n=a("fXoL");window;var i=a("XNiG"),c=a("2Vo4"),o=a("z6cu"),s=a("JIr8"),l=a("vkgz"),r=a("nYR2"),b=a("1G5W"),m=a("lJxs"),p=a("uSps");function d(e){let t=e+"=",a=document.cookie.split(";");for(let n=0;n<a.length;n++){let e=a[n];for(;" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(t))return e.substring(t.length,e.length)}return null}var u=a("tk/3"),g=a("dNgK");let f=(()=>{class e{constructor(e,t){this.http=e,this.matSnack=t,this.onDestroy$=new i.a,this.isLoading$=new c.a(!1)}httpRequest(e,t={},a="get",n){return this.isLoading$.next(!0),this.matSnack.open("Please wait..."),this.http.request(a,`${this.apiBase}/${e}`,{params:t,body:n,responseType:"json"}).pipe(Object(s.a)(e=>(e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):(console.error(`Backend returned code ${e.status}`),this.matSnack.open(`Something bad happened; please try again later. If error persist, contact me at support@wlocalhost.org and include this message: "Error Status ${e.status}".`,"Close",{announcementMessage:"Something bad happened; please try again later."})),Object(o.a)("Something bad happened; please try again later."))),Object(l.a)(()=>this.matSnack.dismiss()),Object(r.a)(()=>this.isLoading$.next(!1)),Object(b.a)(this.onDestroy$))}init(e,t,a){this.apiBase=e,this.csrfName=t,this.csrfToken=d("csrf_cookie_name")||a}getTemplatesByLang(e){return this.httpRequest("templates",{language:e})}getTemplateBody(e){return this.httpRequest("getEmailTemplate",{emailtemplateid:e})}getTemplate(e){return this.httpRequest("getTemplate",{emailtemplateid:e}).pipe(Object(m.a)(e=>({isEdited:!!e.emailObject,email:new p.a(e.emailObject||{structures:[new p.g("cols_1",[[new p.h(e.message)]])]})})))}revertTemplate(e){return this.sendPostRequest(new FormData,`revertTemplate/${e}`).pipe(Object(m.a)(e=>({isEdited:!1,email:new p.a({structures:[new p.g("cols_1",[[new p.h(e.message)]])]})})))}sendPostRequest(e=new FormData,t){return e.append(this.csrfName,this.csrfToken),this.httpRequest(t,{},"post",e)}ngOnDestroy(){this.onDestroy$.next(!0),this.onDestroy$.complete(),this.isLoading$.next(!1),this.isLoading$.complete()}}return e.\u0275fac=function(t){return new(t||e)(n.Ub(u.a),n.Ub(g.a))},e.\u0275prov=n.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),h=(()=>{class e{constructor(){this.templatesCache=new Map}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var w=a("ofXK"),y=a("mrSG"),P=a("itXk"),v=a("xgIS"),O=a("LRne"),C=a("EY2u"),x=a("XqQ8"),Q=a("0IaG"),$=a("XiUz"),k=a("bTqV"),j=a("3Pt+"),A=a("kmnG"),L=a("qFsG"),T=a("MutI"),I=a("f0Cb");function D(e,t){1&e&&(n.Ob(0),n.Qb(1,"h2",2),n.Cc(2,"Are you sure?"),n.Pb(),n.Qb(3,"mat-dialog-content"),n.Cc(4," You are about to close the builder, but there're unsaved changes, which will be lost. Are you sure? "),n.Pb(),n.Qb(5,"mat-dialog-actions",3),n.Qb(6,"button",4),n.Cc(7," No, Go back! "),n.Pb(),n.Qb(8,"button",5),n.Cc(9," Yes, Close it. "),n.Pb(),n.Pb(),n.Nb()),2&e&&(n.wb(8),n.ic("mat-dialog-close",!0))}function _(e,t){1&e&&(n.Ob(0),n.Qb(1,"h2",2),n.Cc(2,"Are you sure?"),n.Pb(),n.Qb(3,"mat-dialog-content"),n.Qb(4,"p"),n.Cc(5,"You are about to restore this template to default Perfex template, all additional changes will be lost."),n.Pb(),n.Qb(6,"p"),n.Qb(7,"strong"),n.Qb(8,"strong"),n.Cc(9,"This will affect only template body, not name nor subject."),n.Pb(),n.Pb(),n.Pb(),n.Qb(10,"p"),n.Qb(11,"strong"),n.Cc(12,"Are you sure?"),n.Pb(),n.Pb(),n.Pb(),n.Qb(13,"mat-dialog-actions",3),n.Qb(14,"button",4),n.Cc(15," No, Go back! "),n.Pb(),n.Qb(16,"button",5),n.Cc(17," Yes, Restore it. "),n.Pb(),n.Pb(),n.Nb()),2&e&&(n.wb(16),n.ic("mat-dialog-close",!0))}function F(e,t){if(1&e&&(n.Qb(0,"mat-list-item"),n.Qb(1,"div",16),n.Qb(2,"span"),n.Cc(3),n.Pb(),n.Qb(4,"code"),n.Cc(5),n.Pb(),n.Pb(),n.Pb()),2&e){const e=n.cc().$implicit;n.wb(3),n.Dc(e.name),n.wb(2),n.Dc(e.key)}}function S(e,t){1&e&&n.Lb(0,"mat-divider")}function M(e,t){if(1&e&&(n.Ob(0),n.Ac(1,F,6,2,"mat-list-item",1),n.Ac(2,S,1,0,"mat-divider",1),n.Nb()),2&e){const e=t.$implicit;n.wb(1),n.ic("ngIf",e.key),n.wb(1),n.ic("ngIf",e.key)}}function E(e,t){if(1&e&&(n.Qb(0,"mat-list",14),n.Ac(1,M,3,2,"ng-container",15),n.Pb()),2&e){const e=n.cc(2);n.wb(1),n.ic("ngForOf",e.data.mergeFields)}}function N(e,t){if(1&e&&(n.Ob(0),n.Qb(1,"h2",2),n.Cc(2,"Edit details"),n.Pb(),n.Qb(3,"mat-dialog-content"),n.Qb(4,"form",null,6),n.Lb(6,"input",7),n.Qb(7,"mat-form-field",8),n.Qb(8,"mat-label"),n.Cc(9,"From Name"),n.Pb(),n.Lb(10,"input",9),n.Pb(),n.Qb(11,"mat-form-field",8),n.Qb(12,"mat-label"),n.Cc(13,"Subject"),n.Pb(),n.Lb(14,"input",10),n.Pb(),n.Pb(),n.Ac(15,E,2,1,"mat-list",11),n.Pb(),n.Qb(16,"mat-dialog-actions",3),n.Qb(17,"button",12),n.Cc(18," Cancel "),n.Pb(),n.Qb(19,"button",13),n.Cc(20," Save "),n.Pb(),n.Pb(),n.Nb()),2&e){const e=n.oc(5),t=n.cc();n.wb(6),n.ic("value",t.data.data.emailtemplateid),n.wb(4),n.ic("value",t.data.data.fromname),n.wb(4),n.ic("value",t.data.data.subject),n.wb(1),n.ic("ngIf",t.data.mergeFields),n.wb(4),n.ic("disabled",!t.checkValidity(e))("mat-dialog-close",e)}}function R(e,t){if(1&e&&(n.Ob(0),n.Qb(1,"h2",2),n.Cc(2,"Send test email"),n.Pb(),n.Qb(3,"mat-dialog-content"),n.Lb(4,"form",null,17),n.Pb(),n.Qb(6,"mat-dialog-actions",3),n.Qb(7,"button",4),n.Cc(8," No, Go back! "),n.Pb(),n.Qb(9,"button",5),n.Cc(10," Yes, Close it. "),n.Pb(),n.Pb(),n.Nb()),2&e){const e=n.oc(5);n.wb(9),n.ic("mat-dialog-close",e)}}let B=(()=>{class e{constructor(e){this.data=e}checkValidity(e){return e.checkValidity()}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(Q.a))},e.\u0275cmp=n.Eb({type:e,selectors:[["app-modal-dialog"]],decls:5,vars:4,consts:[[1,"mat-typography"],[4,"ngIf"],["mat-dialog-title",""],["fxLayoutAlign","space-between center"],["mat-button","","color","warn","cdkFocusInitial","","mat-dialog-close",""],["mat-button","",3,"mat-dialog-close"],["form",""],["type","hidden","name","emailtemplateid",3,"value"],["appearance","fill"],["matInput","","name","fromname","required","","type","text",3,"value"],["matInput","","name","subject","required","","type","text",3,"value"],["dense","",4,"ngIf"],["mat-button","","mat-dialog-close",""],["mat-button","","color","primary","cdkFocusInitial","",3,"disabled","mat-dialog-close"],["dense",""],[4,"ngFor","ngForOf"],["fxFlex","","fxLayout","","fxLayoutAlign","space-between center"],["form","ngForm"]],template:function(e,t){1&e&&(n.Qb(0,"div",0),n.Ac(1,D,10,1,"ng-container",1),n.Ac(2,_,18,1,"ng-container",1),n.Ac(3,N,21,6,"ng-container",1),n.Ac(4,R,11,1,"ng-container",1),n.Pb()),2&e&&(n.wb(1),n.ic("ngIf","confirm"===t.data.type),n.wb(1),n.ic("ngIf","confirm-revert"===t.data.type),n.wb(1),n.ic("ngIf","edit"===t.data.type),n.wb(1),n.ic("ngIf","test-email"===t.data.type))},directives:[w.i,Q.h,Q.e,Q.c,$.b,k.a,Q.d,j.o,j.i,j.j,A.a,A.e,L.a,T.a,w.h,T.c,$.a,$.c,I.a],styles:["[_nghost-%COMP%]{display:block}mat-form-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;height:auto}mat-list[_ngcontent-%COMP%]{max-height:300px;overflow:auto}mat-list[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{-webkit-user-select:all;-moz-user-select:all;-ms-user-select:all;user-select:all}"]}),e})();var Y=a("XhcP"),q=a("/t3+"),z=a("STbY"),G=a("7EHt"),K=a("bv9b"),U=a("+0xr"),J=a("1jcm"),H=a("Qu3c"),V=a("NFeN");let X=(()=>{class e{transform(e,...t){return e.split("_").join(" ")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=n.Jb({name:"keyToLang",type:e,pure:!0}),e})();function W(e,t){1&e&&n.Lb(0,"mat-progress-bar",15)}function Z(e,t){if(1&e&&(n.Qb(0,"button",16),n.Cc(1),n.dc(2,"async"),n.Pb()),2&e){const e=n.cc();n.wb(1),n.Ec(" ",n.ec(2,1,e.getActiveLanguage$)," ")}}function ee(e,t){if(1&e){const e=n.Rb();n.Qb(0,"button",19),n.Yb("click",(function(){n.rc(e);const t=n.cc().$implicit;return n.cc(2).activeLanguage$.next(t)})),n.Cc(1),n.dc(2,"keyToLang"),n.Pb()}if(2&e){const e=n.cc().$implicit;n.wb(1),n.Ec(" ",n.ec(2,1,e)," ")}}function te(e,t){if(1&e&&(n.Ob(0),n.Ac(1,ee,3,3,"button",18),n.dc(2,"async"),n.Nb()),2&e){const e=t.$implicit,a=n.cc(2);n.wb(1),n.ic("ngIf",n.ec(2,1,a.getActiveLanguage$)!==e)}}function ae(e,t){if(1&e&&n.Ac(0,te,3,3,"ng-container",17),2&e){const e=n.cc();n.ic("ngForOf",e.app.languages)}}function ne(e,t){1&e&&n.Lb(0,"mat-header-cell")}function ie(e,t){if(1&e){const e=n.Rb();n.Qb(0,"mat-cell"),n.Qb(1,"mat-slide-toggle",34),n.Yb("change",(function(a){n.rc(e);const i=t.$implicit;return n.cc(2).changeActiveStatus(a,i)})),n.dc(2,"async"),n.Pb(),n.Pb()}if(2&e){const e=t.$implicit,a=n.cc(2);n.wb(1),n.ic("checked",e.active-0==1)("disabled",n.ec(2,2,a.res.isLoading$))}}function ce(e,t){1&e&&(n.Qb(0,"mat-header-cell"),n.Cc(1,"Name"),n.Pb())}function oe(e,t){if(1&e&&(n.Qb(0,"span"),n.Cc(1),n.Pb()),2&e){const e=n.cc().$implicit;n.wb(1),n.Dc(e.name)}}function se(e,t){if(1&e&&(n.Qb(0,"del"),n.Cc(1),n.Pb()),2&e){const e=n.cc().$implicit;n.wb(1),n.Dc(e.name)}}function le(e,t){if(1&e&&(n.Qb(0,"mat-cell"),n.Ac(1,oe,2,1,"span",14),n.Ac(2,se,2,1,"del",14),n.Pb()),2&e){const e=t.$implicit;n.wb(1),n.ic("ngIf","1"===e.active),n.wb(1),n.ic("ngIf","1"!==e.active)}}function re(e,t){1&e&&(n.Qb(0,"mat-header-cell"),n.Cc(1," From Name > Subject "),n.Pb())}function be(e,t){if(1&e&&(n.Qb(0,"span"),n.Cc(1),n.Pb()),2&e){const e=n.cc().$implicit;n.wb(1),n.Ec(" ",e.fromname," > ")}}function me(e,t){if(1&e&&(n.Qb(0,"span"),n.Cc(1),n.dc(2,"date"),n.Pb()),2&e){const e=n.cc().$implicit;n.wb(1),n.Dc(n.fc(2,1,e.updated_at,"short"))}}function pe(e,t){1&e&&(n.Qb(0,"span"),n.Cc(1,"-"),n.Pb())}function de(e,t){if(1&e){const e=n.Rb();n.Qb(0,"mat-cell",35),n.Qb(1,"div"),n.Ac(2,be,2,1,"span",14),n.Cc(3),n.Pb(),n.Qb(4,"div",36),n.Qb(5,"span",37),n.Ac(6,me,3,4,"span",14),n.Ac(7,pe,2,0,"span",14),n.Pb(),n.Qb(8,"button",38),n.Yb("click",(function(){n.rc(e);const a=t.$implicit,i=n.cc().$implicit;return n.cc().changeElementDetails(a,i.key)})),n.dc(9,"async"),n.Qb(10,"mat-icon"),n.Cc(11,"edit"),n.Pb(),n.Pb(),n.Pb(),n.Pb()}if(2&e){const e=t.$implicit,a=n.cc(2);n.wb(2),n.ic("ngIf",e.fromname),n.wb(1),n.Ec(" ",e.subject," "),n.wb(3),n.ic("ngIf",e.updated_at),n.wb(1),n.ic("ngIf",!e.updated_at),n.wb(1),n.ic("disabled",n.ec(9,5,a.res.isLoading$))}}function ue(e,t){1&e&&(n.Qb(0,"mat-header-cell",39),n.Cc(1," Actions "),n.Pb())}function ge(e,t){1&e&&(n.Qb(0,"mat-icon"),n.Cc(1," visibility "),n.Pb())}function fe(e,t){1&e&&(n.Qb(0,"mat-icon"),n.Cc(1," visibility_off "),n.Pb())}function he(e,t){if(1&e){const e=n.Rb();n.Qb(0,"mat-cell",40),n.Qb(1,"button",41),n.Yb("click",(function(){n.rc(e);const a=t.$implicit;return n.cc(2).editTemplate$.next(a)})),n.dc(2,"async"),n.Qb(3,"mat-icon"),n.Cc(4,"dashboard"),n.Pb(),n.Pb(),n.Qb(5,"button",42),n.Yb("click",(function(){n.rc(e);const a=t.$implicit,i=n.cc().$implicit;return n.cc().previewTemplate$.next({id:a.emailtemplateid,type:i.key,name:a.name})})),n.dc(6,"async"),n.Ac(7,ge,2,0,"mat-icon",14),n.Ac(8,fe,2,0,"mat-icon",14),n.Pb(),n.Pb()}if(2&e){const e=t.$implicit,a=n.cc(2);n.wb(1),n.ic("disabled",n.ec(2,4,a.res.isLoading$)),n.wb(4),n.ic("disabled",n.ec(6,6,a.res.isLoading$)),n.wb(2),n.ic("ngIf",e.active-0==1),n.wb(1),n.ic("ngIf",e.active-0==0)}}function we(e,t){1&e&&n.Lb(0,"mat-header-row")}function ye(e,t){1&e&&n.Lb(0,"mat-row")}function Pe(e,t){if(1&e){const e=n.Rb();n.Qb(0,"mat-expansion-panel",20),n.Yb("opened",(function(){n.rc(e);const a=t.$implicit;return n.cc().expansionPanelOpen(a.key)})),n.Qb(1,"mat-expansion-panel-header"),n.Qb(2,"mat-panel-title",21),n.Cc(3),n.dc(4,"keyToLang"),n.Pb(),n.Pb(),n.Qb(5,"mat-table",22),n.Ob(6,23),n.Ac(7,ne,1,0,"mat-header-cell",24),n.Ac(8,ie,3,4,"mat-cell",25),n.Nb(),n.Ob(9,26),n.Ac(10,ce,2,0,"mat-header-cell",24),n.Ac(11,le,3,2,"mat-cell",25),n.Nb(),n.Ob(12,27),n.Ac(13,re,2,0,"mat-header-cell",24),n.Ac(14,de,12,7,"mat-cell",28),n.Nb(),n.Ob(15,29),n.Ac(16,ue,2,0,"mat-header-cell",30),n.Ac(17,he,9,8,"mat-cell",31),n.Nb(),n.Ac(18,we,1,0,"mat-header-row",32),n.Ac(19,ye,1,0,"mat-row",33),n.Pb(),n.Pb()}if(2&e){const e=t.$implicit,a=n.cc();n.ic("expanded",e.key===a.expansionPanelOpen()),n.wb(3),n.Ec(" ",n.ec(4,5,e.key)," "),n.wb(2),n.ic("dataSource",e.value),n.wb(13),n.ic("matHeaderRowDef",a.displayedColumns),n.wb(1),n.ic("matRowDefColumns",a.displayedColumns)}}function ve(e,t){1&e&&(n.Qb(0,"span"),n.Cc(1,"\xa0[Unedited]"),n.Pb())}function Oe(e,t){if(1&e){const e=n.Rb();n.Ob(0),n.Qb(1,"mat-toolbar",43),n.Qb(2,"mat-toolbar-row"),n.Qb(3,"span"),n.Cc(4),n.Pb(),n.Ac(5,ve,2,0,"span",14),n.Qb(6,"button",44),n.Yb("click",(function(){n.rc(e);const a=t.ngIf;return n.cc().openBuilderFromPreview(a)})),n.Cc(7," Edit it on builder "),n.Pb(),n.Pb(),n.Pb(),n.Lb(8,"ip-preview-template",45),n.Nb()}if(2&e){const e=t.ngIf;n.wb(4),n.Dc(e.name),n.wb(1),n.ic("ngIf",!e.is_edited),n.wb(3),n.ic("template",e.html)}}function Ce(e,t){if(1&e){const e=n.Rb();n.Ob(0),n.Qb(1,"mat-toolbar",43),n.Qb(2,"mat-toolbar-row"),n.Qb(3,"span"),n.Cc(4),n.Pb(),n.Qb(5,"div",46),n.Qb(6,"button",47),n.Yb("click",(function(){n.rc(e);const a=t.ngIf;return n.cc().saveEmail(a)})),n.Cc(7," Save "),n.Pb(),n.Qb(8,"button",47),n.Yb("click",(function(){n.rc(e);const a=t.ngIf;return n.cc().saveEmail(a,!0)})),n.Cc(9," Save and Close "),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Qb(10,"ip-email-builder",48),n.Qb(11,"div",49),n.Qb(12,"button",47),n.Yb("click",(function(){n.rc(e);const a=t.ngIf;return n.cc().revertTemplateBack(a.isEdited)})),n.Cc(13," Restore template "),n.Pb(),n.Pb(),n.Pb(),n.Nb()}if(2&e){const e=t.ngIf;n.wb(4),n.Dc(e.name),n.wb(6),n.ic("email",e.email)}}let xe=(()=>{class e{constructor(e,t,a,n,o){this.res=e,this.ngb=t,this.app=a,this.dialog=n,this.el=o,this.onDestroy$=new i.a,this.displayedColumns=["active","name","subject","actions"],this.activeLanguage$=new c.a(null),this.getActiveLanguage$=this.activeLanguage$.pipe(Object(m.a)(e=>e||this.app.activeLanguage),Object(b.a)(this.onDestroy$)),this.previewTemplate$=new c.a(null),this.editTemplate$=new c.a(null),this.openSidenav$=new i.a,this.keyDowns$=Object(P.a)([this.openSidenav$,Object(v.a)(this.el.nativeElement,"keydown")]).pipe(Object(l.a)(([e,t])=>{e&&t.stopImmediatePropagation()}),Object(b.a)(this.onDestroy$)),this.getTemplates$=this.getActiveLanguage$.pipe(Object(x.a)(e=>this.app.templatesCache.has(e)?Object(O.a)(this.app.templatesCache.get(e)):this.res.getTemplatesByLang(e).pipe(Object(l.a)(t=>this.app.templatesCache.set(e,t)))),Object(b.a)(this.onDestroy$)),this.getTemplate$=this.editTemplate$.pipe(Object(x.a)(e=>e?e.email?Object(O.a)(e):this.res.getTemplate(e.emailtemplateid).pipe(Object(m.a)(t=>Object.assign(Object.assign({},e),t))):Object(O.a)(null)),Object(l.a)(e=>{e&&(this.ngb.MergeTags=new Set([...this.app.mergeFields.filter(({type:t})=>t===e.type).map(({key:e})=>e)]))}),Object(l.a)(e=>requestAnimationFrame(()=>this.openSidenav$.next(!!e))),Object(b.a)(this.onDestroy$)),this.getTemplateBody$=this.previewTemplate$.pipe(Object(x.a)(e=>e&&this.res.getTemplateBody(e.id).pipe(Object(m.a)(t=>Object.assign(Object.assign({},t),e)),Object(l.a)(e=>requestAnimationFrame(()=>this.openSidenav$.next(!!e))))||Object(O.a)(null)),Object(b.a)(this.onDestroy$))}closeSidenav(e=!0){return Object(y.a)(this,void 0,void 0,(function*(){let t=!0;e&&this.ngb.hasChanges&&this.editTemplate$.getValue()&&(t=yield this.dialog.open(B,{data:{type:"confirm"},width:"300px",maxWidth:"100%"}).afterClosed().pipe(Object(m.a)(Boolean)).toPromise()),t&&this.editTemplate$.next(null),this.previewTemplate$.next(null),requestAnimationFrame(()=>this.openSidenav$.next(!t))}))}openBuilderFromPreview({id:e,type:t,name:a}){return Object(y.a)(this,void 0,void 0,(function*(){this.previewTemplate$.next(null),yield this.closeSidenav(),requestAnimationFrame(()=>this.editTemplate$.next({emailtemplateid:e,type:t,name:a}))}))}expansionPanelOpen(e){return e&&localStorage.setItem("expansionPanelOpened",e),localStorage.getItem("expansionPanelOpened")||"client"}saveEmail(e,t=!1){return Object(y.a)(this,void 0,void 0,(function*(){let a=!0;if(this.ngb.hasChanges)try{const{email:t,template:n}=yield this.ngb.saveEmail(),i=new FormData,c=this.editTemplate$.getValue();i.append("emailtemplateid",c.emailtemplateid),i.append("emailObject",JSON.stringify(t)),i.append("template",n),a=(yield this.res.sendPostRequest(i,"update").toPromise()).success,e.isEdited=!0,c.updated_at=new Date}catch(n){a=!1,console.error(n),this.ngb.snackBar.open("Something bad happened.","Close")}t&&a&&(yield this.closeSidenav()),a&&this.ngb.snackBar.open("Email template has been saved successfully.",null,{duration:3e3})}))}changeActiveStatus({checked:e,source:t},a){return Object(y.a)(this,void 0,void 0,(function*(){const n=e?1:0,i=new FormData;i.append("emailtemplateid",a.emailtemplateid),i.append("active",String(n));try{(yield this.res.sendPostRequest(i,"changeActiveStatus").toPromise()).success?(a.active=n,a.updated_at=new Date):t.toggle()}catch(c){t.toggle()}}))}changeElementDetails(e,t){return Object(y.a)(this,void 0,void 0,(function*(){const a=yield this.dialog.open(B,{data:{type:"edit",data:e,mergeFields:this.app.mergeFields.filter(e=>t===e.type)},width:"450px",maxWidth:"100%"}).afterClosed().pipe(Object(x.a)(e=>{if(!e)return Object(O.a)({success:!1});const t=new FormData(e);return this.res.sendPostRequest(t,"updateDetails")})).toPromise();a.success&&(e.subject=a.updates.subject,e.fromname=a.updates.fromname,e.updated_at=new Date,this.ngb.snackBar.open("The details have been saved.",null,{duration:3e3}))}))}revertTemplateBack(e){return Object(y.a)(this,void 0,void 0,(function*(){if(e){const e=this.editTemplate$.getValue();this.dialog.open(B,{data:{type:"confirm-revert"},width:"300px",maxWidth:"100%"}).afterClosed().pipe(Object(m.a)(Boolean),Object(x.a)(t=>t&&this.res.revertTemplate(e.emailtemplateid)||C.a),Object(l.a)(e=>this.ngb.Email=e.email),Object(l.a)(()=>delete e.updated_at)).toPromise()}else this.ngb.snackBar.open("You can't restore this tempalte, as it's not edited.",null,{duration:3e3})}))}ngOnInit(){this.keyDowns$.subscribe(),console.log(this.el.nativeElement)}ngOnDestroy(){this.onDestroy$.next(!0),this.onDestroy$.complete(),this.activeLanguage$.complete(),this.previewTemplate$.complete(),this.editTemplate$.complete(),this.openSidenav$.complete()}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(f),n.Kb(p.e),n.Kb(h),n.Kb(Q.b),n.Kb(n.j))},e.\u0275cmp=n.Eb({type:e,selectors:[["app-templates"]],decls:31,vars:25,consts:[[2,"width","100%",3,"backdropClick"],["fxLayout","column wrap","fxLayoutAlign","top center","fxLayoutGap","1rem",1,"mat-typography"],[1,"mat-elevation-z2"],["mode","indeterminate","style","position: absolute;",4,"ngIf"],["fxLayout","","fxLayoutGap","1rem",2,"margin-left","auto"],["mat-flat-button","","color","primary",1,"capitalize",3,"click"],["mat-stroked-button","","color","primary","class","capitalize",4,"ngIf"],["mat-flat-button","",3,"matMenuTriggerFor","disabled"],["langMenu","matMenu"],["matMenuContent",""],[2,"padding","1rem","max-width","1400px","width","100%","box-sizing","border-box"],["fxFlex",""],[3,"expanded","opened",4,"ngFor","ngForOf"],["position","end","disableClose","","mode","over",2,"width","1200px","max-width","80%",3,"opened"],[4,"ngIf"],["mode","indeterminate",2,"position","absolute"],["mat-stroked-button","","color","primary",1,"capitalize"],[4,"ngFor","ngForOf"],["mat-menu-item","","class","capitalize",3,"click",4,"ngIf"],["mat-menu-item","",1,"capitalize",3,"click"],[3,"expanded","opened"],[1,"capitalize"],["fxFlex","",3,"dataSource"],["matColumnDef","active"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","name"],["matColumnDef","subject"],["class","subject-column","fxLayoutAlign","space-between center",4,"matCellDef"],["matColumnDef","actions"],["fxFlex","0 0 144px","fxLayoutAlign","flex-end center",4,"matHeaderCellDef"],["fxLayoutAlign","flex-end","fxFlex","0 0 auto",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["matTooltip","Change active status","matTooltipPosition","above","disableRipple","",3,"checked","disabled","change"],["fxLayoutAlign","space-between center",1,"subject-column"],["fxLayout","","fxLayoutAlign","center center","fxLayoutGap","0.5rem"],["matTooltip","Last updated","matTooltipPosition","above"],["mat-icon-button","","matTooltip","Edit email details","matTooltipPosition","left","aria-label","Edit email details","color","primary",3,"disabled","click"],["fxFlex","0 0 144px","fxLayoutAlign","flex-end center"],["fxLayoutAlign","flex-end","fxFlex","0 0 auto"],["mat-icon-button","","matTooltip","Open on builder","matTooltipPosition","above","aria-label","Open on builder","color","accent",3,"disabled","click"],["mat-icon-button","","matTooltip","Preview","matTooltipPosition","above","aria-label","Preview","color","accent",3,"disabled","click"],["color","primary"],["mat-flat-button","","color","accent",2,"margin-left","auto",3,"click"],[2,"height","100%","justify-content","center",3,"template"],["fxLayoutGap","0.5rem",2,"margin-left","auto"],["mat-flat-button","","color","accent",3,"click"],[2,"height","inherit",3,"email"],[1,"top-actions"]],template:function(e,t){if(1&e&&(n.Qb(0,"mat-sidenav-container",0),n.Yb("backdropClick",(function(){return t.closeSidenav()})),n.Qb(1,"mat-sidenav-content"),n.Qb(2,"div",1),n.Qb(3,"mat-toolbar",2),n.Ac(4,W,1,0,"mat-progress-bar",3),n.dc(5,"async"),n.Qb(6,"mat-toolbar-row"),n.Qb(7,"h1"),n.Cc(8,"Email templates"),n.Pb(),n.Qb(9,"div",4),n.Qb(10,"button",5),n.Yb("click",(function(){return t.activeLanguage$.next(t.app.activeLanguage)})),n.Cc(11),n.Pb(),n.Ac(12,Z,3,3,"button",6),n.dc(13,"async"),n.Qb(14,"button",7),n.dc(15,"async"),n.Cc(16," Other languages "),n.Pb(),n.Qb(17,"mat-menu",null,8),n.Ac(19,ae,1,1,"ng-template",9),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Qb(20,"div",10),n.Qb(21,"mat-accordion",11),n.Ac(22,Pe,20,7,"mat-expansion-panel",12),n.dc(23,"keyvalue"),n.dc(24,"async"),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Qb(25,"mat-sidenav",13),n.dc(26,"async"),n.Ac(27,Oe,9,3,"ng-container",14),n.dc(28,"async"),n.Ac(29,Ce,14,2,"ng-container",14),n.dc(30,"async"),n.Pb(),n.Pb()),2&e){const e=n.oc(18);n.wb(4),n.ic("ngIf",n.ec(5,9,t.res.isLoading$)),n.wb(7),n.Ec(" ",t.app.activeLanguage," "),n.wb(1),n.ic("ngIf",n.ec(13,11,t.getActiveLanguage$)!==t.app.activeLanguage),n.wb(2),n.ic("matMenuTriggerFor",e)("disabled",n.ec(15,13,t.res.isLoading$)),n.wb(8),n.ic("ngForOf",n.ec(23,15,n.ec(24,17,t.getTemplates$))),n.wb(3),n.ic("opened",n.ec(26,19,t.openSidenav$)),n.wb(2),n.ic("ngIf",n.ec(28,21,t.getTemplateBody$)),n.wb(2),n.ic("ngIf",n.ec(30,23,t.getTemplate$))}},directives:[Y.b,Y.c,$.c,$.b,$.d,q.a,w.i,q.c,k.a,z.d,z.e,z.a,G.a,$.a,w.h,Y.a,K.a,z.b,G.c,G.e,G.f,U.j,U.c,U.e,U.b,U.g,U.i,U.d,U.a,J.a,H.a,V.a,U.f,U.h,p.f,p.c],pipes:[w.a,w.e,X,w.d],styles:["[_nghost-%COMP%]{display:block;height:inherit}[_nghost-%COMP%], mat-sidenav-container[_ngcontent-%COMP%]{min-height:inherit}mat-header-row[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:first-child{max-width:84px}mat-cell[_ngcontent-%COMP%]:first-child{max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content;padding-right:24px}mat-cell[_ngcontent-%COMP%]:nth-child(2), mat-header-row[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:nth-child(2){max-width:400px;border-right:1px solid #e0e0e0}mat-cell[_ngcontent-%COMP%]:nth-child(3), mat-header-row[_ngcontent-%COMP%]   mat-header-cell[_ngcontent-%COMP%]:nth-child(3){padding-left:24px}.subject-column[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:0;transition:all .3s ease-in-out;will-change:opacity}.subject-column[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:1}.subject-column[_ngcontent-%COMP%]:hover   button[_ngcontent-%COMP%]:not(:hover){opacity:.5}.mat-drawer-container[_ngcontent-%COMP%]{background:transparent;height:inherit}.force-select[_ngcontent-%COMP%]{-webkit-user-select:all;-moz-user-select:all;-ms-user-select:all;user-select:all;margin-bottom:1rem}"],changeDetection:0}),e})(),Qe=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Eb({type:e,selectors:[["app-campaigns"]],decls:2,vars:0,template:function(e,t){1&e&&(n.Qb(0,"h1"),n.Cc(1,"app-campaigns"),n.Pb())},styles:[""]}),e})();function $e(e,t){1&e&&n.Lb(0,"app-templates")}function ke(e,t){1&e&&n.Lb(0,"app-campaigns")}let je=(()=>{class e{constructor(e,t,a,n){const{activeLanguage:i,templates:c,languages:o,mount:s,apiBase:l,mergeFields:r,csrfToken:b,csrfName:m}=e.nativeElement.dataset;a.activeLanguage=i,a.mergeFields=JSON.parse(r),a.languages=JSON.parse(o),a.templatesCache.set(i,JSON.parse(c)),this.mount=s,t.init(l,m,b),n.uploadImagePath=`${l}/upload`,n.csrf={name:m,token:d("csrf_cookie_name")||b}}}return e.\u0275fac=function(t){return new(t||e)(n.Kb(n.j),n.Kb(f),n.Kb(h),n.Kb(p.b))},e.\u0275cmp=n.Eb({type:e,selectors:[["app-root"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["campaigns",""]],template:function(e,t){if(1&e&&(n.Ac(0,$e,1,0,"app-templates",0),n.Ac(1,ke,1,0,"ng-template",null,1,n.Bc)),2&e){const e=n.oc(2);n.ic("ngIf","templates"===t.mount)("ngIfElse",e)}},directives:[w.i,xe,Qe],styles:["[_nghost-%COMP%] {\n      display: block;\n      height: inherit;\n      min-height: inherit;\n    }"]}),e})();var Ae=a("jhN1"),Le=a("R1ws"),Te=a("sYmb"),Ie=a("d3UM"),De=a("Wp6s"),_e=a("A5z7"),Fe=a("YUcS"),Se=a("wZkO");let Me=(()=>{class e{}return e.\u0275mod=n.Ib({type:e}),e.\u0275inj=n.Hb({factory:function(t){return new(t||e)},imports:[[],w.b,L.b,Ie.b,V.b,j.m,Fe.a,De.a,k.b,j.d,Te.b,H.b,_e.a,U.k,q.b,z.c,Se.d,G.b,Y.d,K.b,T.d,Q.f,J.b]}),e})(),Ee=(()=>{class e{}return e.\u0275mod=n.Ib({type:e}),e.\u0275inj=n.Hb({factory:function(t){return new(t||e)},imports:[[Me,p.d.forChild({xApiKey:"ULMnDh2ens78ge40yU29Q7bbF6r0N5B96VNbebCJ",useDownloadButton:!1,useSaveButton:!1})]]}),e})(),Ne=(()=>{class e{}return e.\u0275mod=n.Ib({type:e}),e.\u0275inj=n.Hb({factory:function(t){return new(t||e)},imports:[[w.b]]}),e})(),Re=(()=>{class e{}return e.\u0275mod=n.Ib({type:e,bootstrap:[je]}),e.\u0275inj=n.Hb({factory:function(t){return new(t||e)},imports:[[Ae.a,Le.b,Me,Ee,Ne]]}),e})();Object(n.N)(),Ae.d().bootstrapModule(Re).catch(e=>console.error(e))}},[[0,0,5]]]);